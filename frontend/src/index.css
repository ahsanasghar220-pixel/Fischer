/* Fonts are loaded asynchronously in index.html to prevent render blocking */

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light theme CSS variables */
    --color-bg-primary: 250 250 250;
    --color-bg-secondary: 255 255 255;
    --color-bg-tertiary: 244 244 245;
    --color-text-primary: 24 24 27;
    --color-text-secondary: 55 55 62; /* Improved contrast: was 63 63 70 */
    --color-text-muted: 82 82 91; /* Improved contrast: was 113 113 122 (now 4.5:1 ratio) */
    --color-border: 228 228 231;
    --color-accent: 244 180 44;
    --glass-bg: rgba(255, 255, 255, 0.8);
    --glass-border: rgba(255, 255, 255, 0.2);
  }

  .dark {
    /* Dark theme CSS variables */
    --color-bg-primary: 9 9 11;
    --color-bg-secondary: 24 24 27;
    --color-bg-tertiary: 39 39 42;
    --color-text-primary: 250 250 250;
    --color-text-secondary: 220 220 224; /* Improved contrast: was 212 212 216 */
    --color-text-muted: 180 180 188; /* Improved contrast: was 161 161 170 (now 4.5:1 ratio) */
    --color-border: 63 63 70;
    --color-accent: 244 180 44;
    --glass-bg: rgba(24, 24, 27, 0.8);
    --glass-border: rgba(255, 255, 255, 0.1);
  }

  html {
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    /* Prevent horizontal scroll on mobile */
    overflow-x: hidden;
  }

  body {
    @apply bg-dark-50 dark:bg-dark-950 text-dark-900 dark:text-dark-50 transition-colors duration-300;
    font-feature-settings: "cv02", "cv03", "cv04", "cv11";
    /* Prevent horizontal scroll on mobile */
    overflow-x: hidden;
    /* Fix iOS touch delay */
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  /* Ensure #root doesn't overflow */
  #root {
    overflow-x: hidden;
    min-height: 100vh;
  }

  /* Custom scrollbar - Light mode */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-dark-100 dark:bg-dark-900;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-dark-300 dark:bg-dark-600 rounded-full;
    border: 2px solid transparent;
    background-clip: content-box;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-dark-400 dark:bg-dark-500;
  }

  /* Selection */
  ::selection {
    @apply bg-primary-500/30 text-dark-900 dark:text-white;
  }

  /* Focus outline */
  *:focus-visible {
    @apply outline-none ring-2 ring-primary-500 ring-offset-2 ring-offset-white dark:ring-offset-dark-900;
  }
}

@layer components {
  /* ========================================
     BUTTONS - Premium styles with gradients
     ======================================== */
  .btn {
    @apply inline-flex items-center justify-center gap-2 px-6 py-3 font-semibold rounded-xl
           transition-all duration-300 ease-out
           focus:outline-none focus:ring-2 focus:ring-offset-2
           disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
           active:scale-[0.98];
  }

  .btn-primary {
    @apply btn bg-gradient-to-r from-primary-500 to-primary-400 text-dark-900
           hover:from-primary-400 hover:to-primary-300 hover:shadow-glow hover:-translate-y-0.5
           focus:ring-primary-500 dark:focus:ring-offset-dark-900;
  }

  .btn-secondary {
    @apply btn bg-dark-900 dark:bg-white text-white dark:text-dark-900
           hover:bg-dark-800 dark:hover:bg-dark-100 hover:-translate-y-0.5
           focus:ring-dark-500;
  }

  .btn-outline {
    @apply btn border-2 border-dark-900 dark:border-white text-dark-900 dark:text-white bg-transparent
           hover:bg-dark-900 dark:hover:bg-white hover:text-white dark:hover:text-dark-900
           focus:ring-dark-500;
  }

  .btn-ghost {
    @apply btn text-dark-700 dark:text-dark-300 bg-transparent
           hover:bg-dark-100 dark:hover:bg-dark-800
           focus:ring-dark-300;
  }

  .btn-danger {
    @apply btn bg-gradient-to-r from-red-500 to-red-400 text-white
           hover:from-red-400 hover:to-red-300 hover:shadow-lg hover:-translate-y-0.5
           focus:ring-red-500;
  }

  .btn-sm {
    @apply px-4 py-2 text-sm rounded-lg;
  }

  .btn-lg {
    @apply px-8 py-4 text-lg rounded-2xl;
  }

  .btn-icon {
    @apply p-2.5 rounded-xl;
  }

  /* ========================================
     INPUTS - Modern floating label style
     ======================================== */
  .input {
    @apply w-full px-4 py-3.5
           bg-white dark:bg-dark-800
           border border-dark-200 dark:border-dark-700
           rounded-xl text-dark-900 dark:text-white
           placeholder:text-dark-400 dark:placeholder:text-dark-500
           focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
           transition-all duration-200;
  }

  .input-error {
    @apply border-red-500 dark:border-red-400 focus:ring-red-500;
  }

  .input-group {
    @apply relative;
  }

  .input-icon {
    @apply absolute left-4 top-1/2 -translate-y-1/2 text-dark-400 dark:text-dark-500 pointer-events-none;
  }

  .input-with-icon {
    @apply pl-12;
  }

  /* ========================================
     CARDS - Glass morphism and premium shadows
     ======================================== */
  .card {
    @apply bg-white dark:bg-dark-800/50 rounded-2xl
           border border-dark-100 dark:border-dark-700/50
           shadow-card backdrop-blur-sm
           transition-all duration-300;
  }

  .card-hover {
    @apply card hover:shadow-card-hover hover:border-dark-200 dark:hover:border-dark-600
           hover:-translate-y-1 cursor-pointer;
  }

  .card-glass {
    @apply bg-white/80 dark:bg-dark-800/60 backdrop-blur-xl
           border border-white/20 dark:border-dark-700/30
           rounded-2xl shadow-xl;
  }

  .card-premium {
    @apply bg-gradient-to-br from-white to-dark-50 dark:from-dark-800 dark:to-dark-900
           rounded-3xl border border-dark-100 dark:border-dark-700
           shadow-premium;
  }

  /* ========================================
     BADGES - Status and tags
     ======================================== */
  .badge {
    @apply inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wide;
  }

  .badge-primary {
    @apply badge bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-300;
  }

  .badge-success {
    @apply badge bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-300;
  }

  .badge-warning {
    @apply badge bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-300;
  }

  .badge-danger {
    @apply badge bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300;
  }

  .badge-info {
    @apply badge bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300;
  }

  .badge-dark {
    @apply badge bg-dark-900 dark:bg-dark-100 text-white dark:text-dark-900;
  }

  /* ========================================
     SECTIONS - Layout helpers
     ======================================== */
  .section {
    @apply py-16 md:py-20 lg:py-24;
  }

  .section-sm {
    @apply py-12 md:py-16;
  }

  .section-title {
    @apply text-3xl md:text-4xl lg:text-5xl font-bold font-display
           text-dark-900 dark:text-white tracking-tight;
  }

  .section-subtitle {
    @apply text-lg md:text-xl text-dark-500 dark:text-dark-400 mt-4 max-w-2xl;
  }

  .container-xl {
    @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8;
  }

  /* ========================================
     PRODUCT CARDS - E-commerce specific
     ======================================== */
  .product-card {
    @apply relative bg-white dark:bg-dark-800/50 rounded-2xl overflow-hidden
           border border-dark-100 dark:border-dark-700/50
           shadow-card hover:shadow-card-hover
           transition-all duration-500 ease-out;
  }

  .product-card:hover {
    @apply -translate-y-2 border-primary-200 dark:border-primary-800;
  }

  .product-card .product-image {
    @apply relative aspect-square overflow-hidden bg-gradient-to-br from-dark-50 to-dark-100 dark:from-dark-800 dark:to-dark-900;
  }

  .product-card .product-image img {
    @apply w-full h-full object-cover transition-transform duration-700 ease-out;
  }

  .product-card:hover .product-image img {
    @apply scale-110;
  }

  .product-card .product-overlay {
    @apply absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent
           opacity-0 group-hover:opacity-100 transition-opacity duration-300;
  }

  .product-card .product-actions {
    @apply absolute bottom-4 left-4 right-4 flex gap-2
           translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100
           transition-all duration-300 delay-100;
  }

  .product-card .product-info {
    @apply p-5;
  }

  .product-card .product-category {
    @apply text-xs font-medium text-primary-600 dark:text-primary-400 uppercase tracking-wider mb-2;
  }

  .product-card .product-name {
    @apply font-semibold text-dark-900 dark:text-white line-clamp-2
           group-hover:text-primary-600 dark:group-hover:text-primary-400
           transition-colors duration-300;
  }

  .product-card .product-price {
    @apply text-xl font-bold text-dark-900 dark:text-white mt-3 flex items-baseline gap-2;
  }

  .product-card .product-price-old {
    @apply text-sm font-normal text-dark-400 line-through;
  }

  .product-card .product-badge {
    @apply absolute top-4 left-4 z-10;
  }

  .product-card .product-wishlist {
    @apply absolute top-4 right-4 z-10 p-2 rounded-full
           bg-white/90 dark:bg-dark-800/90 backdrop-blur-sm
           text-dark-600 dark:text-dark-300
           opacity-0 group-hover:opacity-100
           hover:text-red-500 dark:hover:text-red-400 hover:scale-110
           transition-all duration-300;
  }

  /* ========================================
     SKELETON LOADING
     ======================================== */
  .skeleton {
    @apply bg-gradient-to-r from-dark-200 via-dark-100 to-dark-200
           dark:from-dark-700 dark:via-dark-600 dark:to-dark-700
           bg-[length:200%_100%] animate-shimmer rounded;
  }

  /* ========================================
     GLASS EFFECTS
     ======================================== */
  .glass {
    @apply bg-white/70 dark:bg-dark-900/70 backdrop-blur-xl
           border border-white/20 dark:border-dark-700/30;
  }

  .glass-card {
    @apply glass rounded-2xl shadow-xl;
  }

  /* ========================================
     GRADIENT BORDERS
     ======================================== */
  .gradient-border {
    @apply relative;
  }

  .gradient-border::before {
    content: '';
    @apply absolute inset-0 rounded-2xl p-[2px]
           bg-gradient-to-r from-primary-500 via-primary-400 to-primary-600
           -z-10;
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
  }

  /* ========================================
     ANIMATED GRADIENT BACKGROUND
     ======================================== */
  .gradient-animated {
    background: linear-gradient(-45deg, #f4b42c, #fbbf24, #f59e0b, #d97706);
    background-size: 400% 400%;
    animation: gradient 8s ease infinite;
  }

  /* ========================================
     THEME TOGGLE
     ======================================== */
  .theme-toggle {
    @apply relative w-14 h-7 bg-dark-200 dark:bg-dark-700 rounded-full
           cursor-pointer transition-colors duration-300;
  }

  .theme-toggle::after {
    content: '';
    @apply absolute top-1 left-1 w-5 h-5 bg-white rounded-full
           shadow-md transition-transform duration-300
           dark:translate-x-7 dark:bg-primary-500;
  }

  /* ========================================
     STAT CARDS
     ======================================== */
  .stat-card {
    @apply relative overflow-hidden rounded-2xl p-6
           bg-white dark:bg-dark-800/50
           border border-dark-100 dark:border-dark-700/50;
  }

  .stat-card::before {
    content: '';
    @apply absolute top-0 right-0 w-32 h-32
           bg-gradient-to-br from-primary-500/10 to-transparent
           rounded-bl-full;
  }

  /* ========================================
     NAVIGATION STYLES
     ======================================== */
  .nav-link {
    @apply relative text-dark-600 dark:text-dark-300 font-medium
           hover:text-dark-900 dark:hover:text-white
           transition-colors duration-200;
  }

  .nav-link::after {
    content: '';
    @apply absolute -bottom-1 left-0 w-0 h-0.5
           bg-primary-500 rounded-full
           transition-all duration-300;
  }

  .nav-link:hover::after,
  .nav-link.active::after {
    @apply w-full;
  }

  .nav-link.active {
    @apply text-dark-900 dark:text-white;
  }

  /* ========================================
     DROPDOWN MENUS
     ======================================== */
  .dropdown {
    @apply absolute top-full mt-2 w-56
           bg-white dark:bg-dark-800
           border border-dark-100 dark:border-dark-700
           rounded-xl shadow-xl overflow-hidden
           opacity-0 invisible translate-y-2
           transition-all duration-200;
  }

  .dropdown.open {
    @apply opacity-100 visible translate-y-0;
  }

  .dropdown-item {
    @apply block px-4 py-3 text-dark-700 dark:text-dark-200
           hover:bg-dark-50 dark:hover:bg-dark-700/50
           transition-colors duration-150;
  }

  /* ========================================
     SCROLLBAR HIDE UTILITY
     ======================================== */
  .hide-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .hide-scrollbar::-webkit-scrollbar {
    display: none;
  }
}

@layer utilities {
  /* Line clamp utilities */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Text gradient */
  .text-gradient {
    @apply bg-clip-text text-transparent bg-gradient-to-r from-primary-500 to-primary-400;
  }

  .text-gradient-animated {
    @apply bg-clip-text text-transparent gradient-animated;
  }

  /* Glow effects */
  .glow-sm {
    box-shadow: 0 0 10px rgba(244, 180, 44, 0.3);
  }

  .glow {
    box-shadow: 0 0 20px rgba(244, 180, 44, 0.4);
  }

  .glow-lg {
    box-shadow: 0 0 30px rgba(244, 180, 44, 0.5);
  }

  /* Animation delays */
  .animation-delay-100 { animation-delay: 100ms; }
  .animation-delay-200 { animation-delay: 200ms; }
  .animation-delay-300 { animation-delay: 300ms; }
  .animation-delay-400 { animation-delay: 400ms; }
  .animation-delay-500 { animation-delay: 500ms; }

  /* Enhanced shadow for dark mode glow */
  .shadow-glow-lg {
    box-shadow: 0 0 40px rgba(244, 180, 44, 0.4), 0 0 80px rgba(244, 180, 44, 0.2);
  }

  /* Hero section background pattern */
  .bg-noise {
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
  }

  /* Aspect ratios */
  .aspect-product { aspect-ratio: 4/5; }
  .aspect-banner { aspect-ratio: 21/9; }
  .aspect-hero { aspect-ratio: 16/7; }

  /* Backdrop utilities */
  .backdrop-blur-xs { backdrop-filter: blur(2px); }

  /* Border gradient */
  .border-gradient {
    border: double 2px transparent;
    background-image: linear-gradient(white, white), linear-gradient(to right, #f4b42c, #fbbf24);
    background-origin: border-box;
    background-clip: padding-box, border-box;
  }

  .dark .border-gradient {
    background-image: linear-gradient(#18181b, #18181b), linear-gradient(to right, #f4b42c, #fbbf24);
  }
}

/* ========================================
   MOBILE RESPONSIVENESS FIXES
   ======================================== */
@media (max-width: 640px) {
  /* Ensure text is readable on mobile */
  html {
    font-size: 15px;
  }

  /* Better touch targets */
  button, a, input, select, textarea {
    min-height: 44px;
  }

  /* Fix button sizes on mobile */
  .btn {
    @apply px-4 py-3 text-sm;
  }

  /* Prevent text from being too large */
  h1 {
    @apply text-3xl !important;
  }

  h2 {
    @apply text-2xl !important;
  }

  /* Better spacing on mobile */
  .container-xl {
    @apply px-4;
  }

  /* Fix product cards on mobile */
  .product-card .product-image {
    @apply aspect-square;
  }

  /* Smaller images on mobile */
  img {
    max-width: 100%;
    height: auto;
  }

  /* Fix table overflow on mobile */
  table {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
  }

  /* Hide scrollbar on mobile for horizontal scroll elements */
  .overflow-x-auto::-webkit-scrollbar {
    display: none;
  }
}

/* ========================================
   TABLET FIXES
   ======================================== */
@media (min-width: 641px) and (max-width: 1023px) {
  /* Better grid layouts for tablets */
  .grid-cols-4 {
    @apply grid-cols-2;
  }

  .grid-cols-3 {
    @apply grid-cols-2;
  }
}

/* ========================================
   SAFE AREA INSETS (for notched phones)
   ======================================== */
@supports (padding: max(0px)) {
  body {
    padding-left: max(0px, env(safe-area-inset-left));
    padding-right: max(0px, env(safe-area-inset-right));
  }

  /* Bottom navigation/footer padding */
  .pb-safe {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }
}
